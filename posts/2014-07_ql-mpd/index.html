<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title> Quod Libet 3.2 - MPD Server &mdash; ~ 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="~ 0.1 documentation" href="../../index.html" />
    <link rel="prev" title="Projects" href="../../pages/projects.html" />
   
  <link href='//fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../pages/projects.html" title="Projects"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">~ 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="quod-libet-3-2-mpd-server">
<h1> Quod Libet 3.2 - MPD Server<a class="headerlink" href="#quod-libet-3-2-mpd-server" title="Permalink to this headline">¶</a></h1>
<p>It&#8217;s again time for another Quod Libet release and this time I thought it
might be nice to give an overview of all the new stuff that made it in.</p>
<div class="section" id="new-android-remote-control-mpd-server-plugin">
<h2>New Android Remote Control / MPD Server Plugin<a class="headerlink" href="#new-android-remote-control-mpd-server-plugin" title="Permalink to this headline">¶</a></h2>
<div class="figure align-right">
<a class="screenshot reference internal image-reference" href="../../_images/mpdroid.png"><img alt="../../_images/mpdroid.png" class="screenshot" src="../../_images/mpdroid.png" style="width: 200px;" /></a>
</div>
<p>This one was quite fun. Someone pointed out that it would be nice to have an
Android remote control app, like Banshee and Clementine have nowadays. Since
it isn&#8217;t an easy undertaking to create and maintain an Android app I tried a
few existing ones with the final goal to just re-implement the server side
interface in QL and reuse the app for free. That&#8217;s when I noticed that there
are lots of <a class="reference external" href="http://www.musicpd.org/">MPD</a> clients available and even
though the MPD protocol is probably overkill for a simple remote control, it
guarantees us that there will always be a maintained client, given that mpd
remains popular. There even might be a good client for iOS or Windows Phone,
but I haven&#8217;t looked into that.</p>
<p>In the end it turned out that even though there are lots of clients for
Android, there is only one that&#8217;s good enough and that&#8217;s <a class="reference external" href="https://play.google.com/store/apps/details?id=com.namelessdev.mpdroid">MPDroid</a>.
It&#8217;s luckily also the most popular one and actively maintained.</p>
<p>MPD exposes one main playlist, some non-main ones plus a library. The playing
song has to be part of a playlist and changes to playlists need to be tracked
and synced with the client. Because I didn&#8217;t want to implement all this
mapping between the mpd way and the QL one, I tricked the client into being a
remote control only.</p>
<p>For this to work, QL exposes one playlist that only contains the active song.
When the client tries to jump to the next one, QL changes the playlist by
exchanging the song with the next one and marks it as playing. While this
should theoretically work (say, a second client changed the playlist at the
right/wrong moment), many clients get confused, stuck or crash. Luckily
MPDroid does what we want in this case.</p>
<p>Another nice thing about MPDroid is that is uses the newer mpd &#8216;idle&#8217; command
which lets the client subscribe to events and wait until something happens.
For this it opens an additional connection to the server which only listens
for changes, while the first connection gets used for issuing commands like
seeking. As a result both devices only have to wake up on song changes or if
you change something in QL or MPDroid. No reason to switch it off if you don&#8217;t
use it anymore. Most other clients, including all GUI desktop clients I&#8217;ve
tried, poll the server every second.</p>
<p>One thing which caught me by surprise a bit was MPDroid pausing the music
while you receive a call on your phone. At first I thought QL was acting up,
but it turned out to be a feature and not a bug :)</p>
<div class="section" id="setting-it-up">
<h3>Setting it up<a class="headerlink" href="#setting-it-up" title="Permalink to this headline">¶</a></h3>
<div class="figure align-right">
<a class="screenshot reference internal image-reference" href="../../_images/mpd_settings.png"><img alt="../../_images/mpd_settings.png" class="screenshot" src="../../_images/mpd_settings.png" style="width: 200px;" /></a>
</div>
<ul class="simple">
<li>Enable the &#8216;MPD Server&#8217; plugin in QL. It will allow you to change the port,
but this is only needed if you run another mpd instance on your machine. The
displayed IP address is what you need to tell MPDroid. QL currently doesn&#8217;t
support mpd password authentication, but this will probably be added for the
next version.</li>
<li>MPDroid remembers one connection configuration per Wifi network. To set it
up go to <tt class="docutils literal"><span class="pre">Settings</span></tt>, <tt class="docutils literal"><span class="pre">Connection</span> <span class="pre">Settings</span></tt>, <tt class="docutils literal"><span class="pre">WLAN</span> <span class="pre">based</span> <span class="pre">connection</span></tt>
and select the Network you are currently connected to and set the <tt class="docutils literal"><span class="pre">Host</span></tt>
to the IP address shown in the QL plugin preferences.</li>
</ul>
<div class="figure align-right">
<a class="screenshot reference internal image-reference" href="../../_images/mpdroid_settings.png"><img alt="../../_images/mpdroid_settings.png" class="screenshot" src="../../_images/mpdroid_settings.png" style="width: 200px;" /></a>
</div>
<p>It&#8217;s not that much work, but if you switch your network regularly and get
assigned a different IP each time this can get cumbersome.</p>
<p>For this case QL, like the real mpd, registers the mpd interface through
<a class="reference external" href="https://en.wikipedia.org/wiki/Avahi_%28software%29">Avahi</a> (aka
Zeroconf/Bonjour). This allows mpd clients on the same network to look for
machines which provide a mpd interface and fetch the IP and port number. Sadly
this <a class="reference external" href="https://github.com/abarisain/dmix/issues/576">isn&#8217;t implemented yet in MPDroid</a> and also resolving the IP
and port from the hostname doesn&#8217;t work due to <a class="reference external" href="https://code.google.com/p/android/issues/detail?id=19550">shortcomings in Android</a>. Once it is
implemented though, no configuration will be needed in the common case and it
will simply work once you connect both devices to the same network *fingers
crossed*.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">~</a></h1>






<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pages/about.html">About Me</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pages/projects.html">Projects</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">[2014-07] Quod Libet 3.2 - MPD Server</a><ul class="simple">
</ul>
</li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://lazka.github.io/pgi-docs">Python GI API Reference</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/lazka/pgi-docgen">PGI Docgen</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/lazka/pgi">PGI</a></li>
    
    <li class="toctree-l1"><a href="https://code.google.com/p/quodlibet">Quod Libet</a></li>
    
    <li class="toctree-l1"><a href="https://bitbucket.org/lazka/mutagen">Mutagen</a></li>
    
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Christoph Reiter.
      
    </div>

    

    
  </body>
</html>